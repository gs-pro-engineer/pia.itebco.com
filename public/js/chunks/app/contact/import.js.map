{"version":3,"file":"js/chunks/app/contact/import.js?id=a4f9fc72a21edb26ec48","sources":["webpack:///import.vue","webpack:///./resources/js/views/app/contact/import.vue?c7dd","webpack:///./resources/js/views/app/contact/import.vue","webpack:///./resources/js/views/app/contact/import.vue?5064","webpack:///./resources/js/views/app/contact/import.vue?a362"],"sourcesContent":["<template>\n  <base-container\n    boxed\n    with-loader\n    :is-loading=\"isLoading\"\n    :loader-color=\"vars.loaderColor\"\n  >\n    <form @submit.prevent=\"submit\">\n      <div class=\"py-5\" v-if=\"!formData.uploaded\">\n        <file-uploader\n          name-label=\"upload.file\"\n          :options=\"uploaderConfig\"\n          @updated=\"handleFileUpload\"\n          :multiple=\"false\"\n          url=\"/contacts/import/start\"\n          button-classes=\"justify-content-center\"\n        />\n      </div>\n\n      <div class=\"mt-3\" v-else>\n        <h5 class=\"pb-4\">{{ $t(\"general.choose_columns\") }}</h5>\n\n        <div class=\"row\">\n          <div\n            class=\"col-12 col-md-3 mb-5\"\n            v-for=\"(column, index) in formData.columns\"\n          >\n            <base-select\n              :options=\"preRequisite.options\"\n              v-model=\"column.selected\"\n              :label=\"$t('general.column', { number: index + 1 })\"\n              :error.sync=\"formErrors['column' + index]\"\n              :allow-empty=\"false\"\n              :disabled=\"isLoading\"\n            />\n\n            <h6 class=\"small text-muted px-2 font-weight-bold\">\n              {{ $t(\"general.sample\") }}:\n\n              <span class=\"text-muted px-2 comma-list\">\n                <template v-for=\"item in preRequisite.items\">\n                  <span v-if=\"item[index]\">{{ item[index] }}</span>\n                </template>\n              </span>\n            </h6>\n          </div>\n        </div>\n\n        <div class=\"form-footer\">\n          <div class=\"right-side\">\n            <base-button type=\"submit\" design=\"primary\">{{\n              $t(\"global.import\", { attribute: $t(\"contact.contacts\") })\n            }}</base-button>\n          </div>\n        </div>\n      </div>\n    </form>\n  </base-container>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from \"vuex\";\nimport EventBus from \"@js/event-bus\";\nimport FileUploader from \"@components/FileUploader\";\n\nexport default {\n  components: {\n    FileUploader,\n  },\n  data() {\n    return {\n      formData: {\n        uuid: null,\n        columns: [],\n        updated: false,\n        uploaded: false,\n      },\n      formErrors: {},\n      preRequisite: {\n        items: [],\n        options: [],\n      },\n      uploaderConfig: {\n        allowedExtensions: [\"csv\"],\n        maxNoOfFiles: 1,\n      },\n      initialFormData: null,\n      isLoading: false,\n    };\n  },\n  computed: {\n    ...mapGetters(\"config\", [\"vars\"]),\n  },\n  methods: {\n    ...mapActions(\"common\", [\"Store\", \"Init\"]),\n    submit() {\n      if (formUtil.isUnchanged(this.initialFormData, this.formData)) {\n        this.$toasted.info(\n          this.$t(\"general.nothing_changed\"),\n          this.$toastConfig.info\n        );\n        return false;\n      }\n\n      formUtil.confirmAction().then((result) => {\n        if (result.value) {\n          this.isLoading = true;\n\n          this.Store(this.formData)\n            .then((response) => {\n              this.$toasted.success(response.message, this.$toastConfig);\n              this.clear();\n              this.isLoading = false;\n            })\n            .catch((error) => {\n              this.isLoading = false;\n              this.formErrors = formUtil.handleErrors(error);\n            });\n        }\n      });\n    },\n    unsavedCheck(next) {\n      formUtil.unsavedCheckAlert(this.initialFormData, this.formData, next);\n    },\n    clear() {\n      this.formData.uuid = null;\n      this.preRequisite.items = [];\n      this.preRequisite.options = [];\n      this.formData.columns = [];\n      this.formData.uploaded = false;\n      this.formData.updated = false;\n    },\n    handleFileUpload(response) {\n      console.log(\"Contact Import CSV File response==========\", response);\n      if (response.uuid) {\n        this.formData.uuid = response.uuid;\n        this.preRequisite.items = response.items;\n        this.preRequisite.options = response.options;\n        const itemsObj = response.items[0];\n        const items = Array.from(Object.keys(itemsObj), (k) => itemsObj[k]);\n        this.formData.columns = items.map((val, index) => {\n          return {\n            selected: response.options[index],\n          };\n        });\n        this.formData.uploaded = true;\n        this.formData.updated = true;\n      }\n    },\n  },\n  mounted() {\n    EventBus.$off(\"ROUTE_LEAVING\", this.unsavedCheck);\n    EventBus.$on(\"ROUTE_LEAVING\", this.unsavedCheck);\n    this.Init({ url: \"contacts/import/finish\" });\n  },\n  destroyed() {\n    EventBus.$off(\"ROUTE_LEAVING\", this.unsavedCheck);\n  },\n  beforeRouteLeave(to, from, next) {\n    EventBus.$emit(\"ROUTE_LEAVING\", next);\n  },\n};\n</script>\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"base-container\",\n    {\n      attrs: {\n        boxed: \"\",\n        \"with-loader\": \"\",\n        \"is-loading\": _vm.isLoading,\n        \"loader-color\": _vm.vars.loaderColor\n      }\n    },\n    [\n      _c(\n        \"form\",\n        {\n          on: {\n            submit: function($event) {\n              $event.preventDefault()\n              return _vm.submit.apply(null, arguments)\n            }\n          }\n        },\n        [\n          !_vm.formData.uploaded\n            ? _c(\n                \"div\",\n                { staticClass: \"py-5\" },\n                [\n                  _c(\"file-uploader\", {\n                    attrs: {\n                      \"name-label\": \"upload.file\",\n                      options: _vm.uploaderConfig,\n                      multiple: false,\n                      url: \"/contacts/import/start\",\n                      \"button-classes\": \"justify-content-center\"\n                    },\n                    on: { updated: _vm.handleFileUpload }\n                  })\n                ],\n                1\n              )\n            : _c(\"div\", { staticClass: \"mt-3\" }, [\n                _c(\"h5\", { staticClass: \"pb-4\" }, [\n                  _vm._v(_vm._s(_vm.$t(\"general.choose_columns\")))\n                ]),\n                _vm._v(\" \"),\n                _c(\n                  \"div\",\n                  { staticClass: \"row\" },\n                  _vm._l(_vm.formData.columns, function(column, index) {\n                    return _c(\n                      \"div\",\n                      { staticClass: \"col-12 col-md-3 mb-5\" },\n                      [\n                        _c(\"base-select\", {\n                          attrs: {\n                            options: _vm.preRequisite.options,\n                            label: _vm.$t(\"general.column\", {\n                              number: index + 1\n                            }),\n                            error: _vm.formErrors[\"column\" + index],\n                            \"allow-empty\": false,\n                            disabled: _vm.isLoading\n                          },\n                          on: {\n                            \"update:error\": function($event) {\n                              return _vm.$set(\n                                _vm.formErrors,\n                                \"column\" + index,\n                                $event\n                              )\n                            }\n                          },\n                          model: {\n                            value: column.selected,\n                            callback: function($$v) {\n                              _vm.$set(column, \"selected\", $$v)\n                            },\n                            expression: \"column.selected\"\n                          }\n                        }),\n                        _vm._v(\" \"),\n                        _c(\n                          \"h6\",\n                          {\n                            staticClass:\n                              \"small text-muted px-2 font-weight-bold\"\n                          },\n                          [\n                            _vm._v(\n                              \"\\n            \" +\n                                _vm._s(_vm.$t(\"general.sample\")) +\n                                \":\\n\\n            \"\n                            ),\n                            _c(\n                              \"span\",\n                              { staticClass: \"text-muted px-2 comma-list\" },\n                              [\n                                _vm._l(_vm.preRequisite.items, function(item) {\n                                  return [\n                                    item[index]\n                                      ? _c(\"span\", [\n                                          _vm._v(_vm._s(item[index]))\n                                        ])\n                                      : _vm._e()\n                                  ]\n                                })\n                              ],\n                              2\n                            )\n                          ]\n                        )\n                      ],\n                      1\n                    )\n                  }),\n                  0\n                ),\n                _vm._v(\" \"),\n                _c(\"div\", { staticClass: \"form-footer\" }, [\n                  _c(\n                    \"div\",\n                    { staticClass: \"right-side\" },\n                    [\n                      _c(\n                        \"base-button\",\n                        { attrs: { type: \"submit\", design: \"primary\" } },\n                        [\n                          _vm._v(\n                            _vm._s(\n                              _vm.$t(\"global.import\", {\n                                attribute: _vm.$t(\"contact.contacts\")\n                              })\n                            )\n                          )\n                        ]\n                      )\n                    ],\n                    1\n                  )\n                ])\n              ])\n        ]\n      )\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./import.vue?vue&type=template&id=376e2861&\"\nimport script from \"./import.vue?vue&type=script&lang=js&\"\nexport * from \"./import.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/pia.itebco.com/public_html/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('376e2861')) {\n      api.createRecord('376e2861', component.options)\n    } else {\n      api.reload('376e2861', component.options)\n    }\n    module.hot.accept(\"./import.vue?vue&type=template&id=376e2861&\", function () {\n      api.rerender('376e2861', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"resources/js/views/app/contact/import.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./import.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./import.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./import.vue?vue&type=template&id=376e2861&\""],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AAEA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AACA;AAjBA;AAmBA;AACA;AAGA;AAEA;AAAA;AACA;AAAA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AAvDA;AAyDA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/FA;;;;;;;;;;;;ACjEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACxJA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAiBA;AACA;AACA;;;;;;;;;;;;ACtCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}